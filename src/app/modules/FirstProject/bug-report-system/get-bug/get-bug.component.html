<div class="container text-center">
  <form #searchForm="ngForm" (ngSubmit)="onSubmit(searchForm)" class='px-3 pt-3' style="background-color:  #323C50">
    <div class="form-row d-flex justify-content-around align-items-end">
      <div class="form-group">
        <input id="title" name="title" [(ngModel)]="searchedBug.title" type="text" class="form-control" required
          placeholder="Title" autocomplete="off">
      </div>
      <div class="form-group">
        <select id="priority" name="priority" [ngModel]="selectedPriority" (ngModelChange)="onChangePriority($event)"
          class="form-control" required>
          <option ngValue="" hidden>Priority</option>
          <option *ngFor="let i of priorityOptions" [ngValue]="i.key">{{i.name}}</option>
        </select>
      </div>
      <div class="form-group">
        <select id="reporter" name="reporter" [ngModel]="selectedReporter" (ngModelChange)="onChangeReporter($event)"
          class="form-control" required>
          <option ngValue="" hidden>Reporter</option>
          <option *ngFor="let i of reporterOptions" [ngValue]="i.key">{{i.name}}</option>
        </select>
      </div>
      <div class="form-group">
        <select id="status" name="status" [ngModel]="selectedStatus" (ngModelChange)="onChangeStatus($event)"
          class="form-control" required>
          <option ngValue="" hidden>Status</option>
          <option *ngFor="let i of statusOptions" [ngValue]="i.key">{{i.name}}</option>
        </select>
      </div>
      <button type="submit" class="btn editButtonId form-group">Search</button>
      <button type="button" class="btn editButtonId form-group" (click)="removeFilters()">Clear Filters</button>
      <button (click)="insertBug()" class="btn editButtonId form-group">Insert New Bug</button>
    </div>
  </form>

  <table class="table table-bordered table-hover">
    <!-- <caption class="text-center font-italic">List of bugs</caption> -->
    <thead>
      <tr>
        <!--<th (click)="sort('index')">Index<i [ngClass]="'fa fa-sort'" style="float:right"></i> </th>-->
        <th (click)="sort('title')">Title
          <i *ngIf="(sortingDirection === 'asc' || sortingDirection === 'desc') && sortByVar !== 'title'"
            [ngClass]="'fa fa-sort iconColor'"></i>
          <i *ngIf="sortingDirection === 'asc' && sortByVar === 'title'" [ngClass]="'fa fa-sort-up'"></i>
          <i *ngIf="sortingDirection === 'desc' && sortByVar === 'title'" [ngClass]="'fa fa-sort-down'"></i>
        </th>
        <th (click)="sort('priority')">Priority
          <i *ngIf="(sortingDirection === 'asc' || sortingDirection === 'desc') && sortByVar !== 'priority'"
            [ngClass]="'fa fa-sort iconColor'"></i>
          <i *ngIf="sortingDirection === 'asc' && sortByVar === 'priority'" [ngClass]="'fa fa-sort-up'"></i>
          <i *ngIf="sortingDirection === 'desc' && sortByVar === 'priority'" [ngClass]="'fa fa-sort-down'"></i>
        </th>
        <th (click)="sort('reporter')">Reporter
          <i *ngIf="(sortingDirection === 'asc' || sortingDirection === 'desc') && sortByVar !== 'reporter'"
            [ngClass]="'fa fa-sort iconColor'"></i>
          <i *ngIf="sortingDirection === 'asc' && sortByVar === 'reporter'" [ngClass]="'fa fa-sort-up'"></i>
          <i *ngIf="sortingDirection === 'desc' && sortByVar === 'reporter'" [ngClass]="'fa fa-sort-down'"></i>
        </th>
        <th (click)="sort('createdAt')">Date Created
          <i *ngIf="(sortingDirection === 'asc' || sortingDirection === 'desc') && sortByVar !== 'createdAt'"
            [ngClass]="'fa fa-sort iconColor'"></i>
          <i *ngIf="sortingDirection === 'asc' && sortByVar === 'createdAt'" [ngClass]="'fa fa-sort-up'"></i>
          <i *ngIf="sortingDirection === 'desc' && sortByVar === 'createdAt'" [ngClass]="'fa fa-sort-down'"></i>
        </th>
        <th (click)="sort('status')">Status
          <i *ngIf="(sortingDirection === 'asc' || sortingDirection === 'desc') && sortByVar !== 'status'"
            [ngClass]="'fa fa-sort iconColor'"></i>
          <i *ngIf="sortingDirection === 'asc' && sortByVar === 'status'" [ngClass]="'fa fa-sort-up'"></i>
          <i *ngIf="sortingDirection === 'desc' && sortByVar === 'status'" [ngClass]="'fa fa-sort-down'"></i>
        </th>
        <th> </th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let bug of bugs">
        <td>{{bug.title}}</td>
        <!-- <td>{{bug.priority | stringifyPriority}}</td> -->
        <td>{{bug.priority | stringifyPriority}}</td>
        <td>{{bug.reporter | uppercase}}</td>
        <td>{{bug.createdAt | date: 'd/M/yy - H:mm'}}</td>
        <td>{{bug.status | capitalize }}</td>
        <td><button class="editButtonId" value="editBugMethod" (click)="editBugMethod(bug.id)">Edit</button></td>
        <td><button class="editButtonId" value="deleteBugMethod" (click)="deleteBugMethod(bug.id)">Delete</button></td>
      </tr>
      <tr *ngIf="bugs.length === 0">
      <td colspan='7' class="font-weight-bold">No matching records found</td>
      </tr>
    </tbody>
  </table>
  <div id="pagination">
    <button id="previousPageButton" class="editButtonId" [disabled]="page === 0" (click)="previousPage()">Previous</button>
    <div style="color:beige; display: inline-block; margin: 0 1rem">{{page + 1}}</div>
    <button id="nextPageButton" class="editButtonId" [disabled]="bugsNext.length === 0 && bugs.length !== 10" (click)="nextPage()">Next</button>
  </div>
</div>
